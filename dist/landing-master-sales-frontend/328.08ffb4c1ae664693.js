"use strict";(self.webpackChunklanding_master_sales_frontend=self.webpackChunklanding_master_sales_frontend||[]).push([[328,906,527,387],{2671:(_,f,o)=>{o.d(f,{y:()=>h});var r=o(529),l=o(5625),t=o(262),m=o(2843),g=o(7065),c=o(4650);let h=(()=>{class s{constructor(n){this.httpClient=n,this.apiUrl=`${g.N.ClientSearchApiUrl}`,this.headers=new r.WM,this.httpOptions={}}getClientByMovil(n,p){return this.headers={"Content-Type":"application/json",Authorization:"Bearer "+p},this.httpClient.get(`${this.apiUrl}/${n}`,{headers:this.headers})}getClientByDNI(n,p){const S={headers:{"Content-Type":"application/json",Authorization:"Bearer "+p}},C=JSON.stringify({documentId:n,documentType:""});return this.httpClient.post(`${this.apiUrl}`,C,S).pipe((0,l.X)(1),(0,t.K)(this.handleError))}handleError(n){return n.error instanceof ErrorEvent?console.error("An error occurred:",n.error.message):console.error(`Backend returned code ${n.status}, body was: ${n.error}`),(0,m._)("Something bad happened; please try again later.")}}return s.\u0275fac=function(n){return new(n||s)(c.LFG(r.eN))},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},4527:(_,f,o)=>{o.d(f,{N:()=>g});var r=o(7065),l=o(4004),t=o(4650),m=o(529);let g=(()=>{class c{constructor(s){this.http=s,this.endPoint=r.N.endPoint,this.endPointMgd=r.N.urlMgd}createOrder(s,e){return this.http.post(this.endPoint+"/order/create/orderMain",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}registerOrderView(s,e){return this.http.post(this.endPoint+"/order/registers/orderView",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}createPerson(s,e){return this.http.post(this.endPoint+"/sales/creates/client/person",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}uploadDocuments(s,e){return this.http.post(this.endPointMgd+"/documents/upload",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}getItemsPlan(s,e){return this.http.post(this.endPoint+"/product/items",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}getItemDetail(s,e){return this.http.post(this.endPoint+"/product/item",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}registerItemsSale(s,e){return this.http.post(this.endPoint+"/order/saleItem/register",s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}getPersonAdditionalData(s,e){return this.http.get(this.endPoint+"/crm360/client/persondata/search/"+s,{headers:{Authorization:"Bearer "+e}}).pipe((0,l.U)(d=>d))}}return c.\u0275fac=function(s){return new(s||c)(t.LFG(m.eN))},c.\u0275prov=t.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},6616:(_,f,o)=>{o.d(f,{B:()=>h});var r=o(529),l=o(5625),t=o(262),m=o(2843),g=o(7065),c=o(4650);let h=(()=>{class s{constructor(n){this.httpClient=n,this.urToken=`${g.N.SSIAuthApiUrl}`,this.httpOptions={headers:new r.WM({"Content-Type":"application/json"})}}gettoken(){return this.httpClient.post(`${this.urToken}`,JSON.stringify({username:"landing",password:"3X4E+U7d1m1XprRamjfaRg=="}),this.httpOptions).pipe((0,l.X)(1),(0,t.K)(this.handleError))}handleError(n){return n.error instanceof ErrorEvent?console.error("An error occurred:",n.error.message):console.error(`Backend returned code ${n.status}, body was: ${n.error}`),(0,m._)("Something bad happened; please try again later.")}}return s.\u0275fac=function(n){return new(n||s)(c.LFG(r.eN))},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},3063:(_,f,o)=>{o.d(f,{f:()=>c});var r=o(7065),l=o(1002),t=o(4650),m=o(5219),g=o(529);let c=(()=>{class h{constructor(e,n,p){this.sessionStorageService=e,this.localStorageService=n,this.httpClient=p,this.httpPostOptions=l.z8,this.httpGetOptions=l.bN,this.apiUrl=`${r.N.SSIAuthApiUrl}`}saveToken(){this.httpClient.post(`${r.N.SSIAuthApiUrl}`,JSON.stringify({username:r.N.SSITokenUsername,password:r.N.SSITokenPassword}),this.httpPostOptions).subscribe(n=>{n.data?.token&&localStorage.setItem("TOKEN",n.data.token),this.localStorageService.store("TOKEN",n.data?.token),this.sessionStorageService.store("token",n.data?.token),this.sessionStorageService.store("userId",n.data?.userId)})}saveAuthenticateInformation(e){this.sessionStorageService.store("authenticateInformation",e)}getAuthenticateInformation(){return this.sessionStorageService.retrieve("authenticateInformation")}saveClientInformation(e){this.sessionStorageService.store("clientInformation",e)}getClientInformation(){return this.sessionStorageService.retrieve("clientInformation")}saveDeliveryStoreMethod(e){this.sessionStorageService.store("storeInfo",e)}getDeliveryStoreMethod(){return this.sessionStorageService.retrieve("storeInfo")}saveSelfie(e){this.sessionStorageService.store("photoFace",e)}saveMovilListinformation(e){this.sessionStorageService.store("movilListInfo",e)}getMovilListInformation(){return this.sessionStorageService.retrieve("movilListInfo")}getSelfie(){return console.log(this.sessionStorageService.retrieve("photoFace")),this.sessionStorageService.retrieve("photoFace")}saveDocument(e,n){this.sessionStorageService.store(e,n)}getDocument(e){return this.sessionStorageService.retrieve(e)}savePlanCompositionCode(e){this.sessionStorageService.store("planCompositionCode",e)}getPlanCompositionCode(){return this.sessionStorageService.retrieve("planCompositionCode")}savePlanComposition(e){this.sessionStorageService.store("planComposition",e)}getPlanComposition(){return this.sessionStorageService.retrieve("planComposition")}clearWebStorePlanComposition(){this.sessionStorageService.clear(),this.sessionStorageService.clear("planCompositionCode"),this.sessionStorageService.clear("planComposition")}saveStatusScoring(e){this.sessionStorageService.store("statusScoring",e)}getStatusScoring(){return this.sessionStorageService.retrieve("statusScoring")}saveDataInSession(e,n){this.sessionStorageService.store(e,n)}getDataInSession(e){return this.sessionStorageService.retrieve(e)}getScoring(){return this.sessionStorageService.retrieve("scoring")}getOfferConsuptioncode(){return this.sessionStorageService.retrieve("offerconsumptionformcode")}getOfferTotaldetail(){return this.sessionStorageService.retrieve("offertotaltariff")}saveAutomaticPayment(e){this.sessionStorageService.store("automaticPayment",e)}}return h.\u0275fac=function(e){return new(e||h)(t.LFG(m.uR),t.LFG(m.n2),t.LFG(g.eN))},h.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},2328:(_,f,o)=>{o.r(f),o.d(f,{OfferModule:()=>B});var r=o(6895),l=o(3060),t=o(4650),m=o(2671),g=o(6616),c=o(529),h=o(5625),s=o(262),e=o(2843),n=o(7065);let p=(()=>{class a{constructor(i){this.httpClient=i,this.apiUrl=`${n.N.CatalogProductApiUrl}`,this.headers=new c.WM,this.httpOptions={}}getPlanList(i){var u={"Content-Type":"application/json",Authorization:"Bearer "+i};const P=JSON.stringify({channel:"CAVENT",city:null,clientId:null,sourcePlan:null,transactionType:"VENTA",userId:21,workplace:null});return this.httpClient.post(`${this.apiUrl}`,P,{headers:u}).pipe((0,h.X)(1),(0,s.K)(this.handleError))}handleError(i){return i.error instanceof ErrorEvent?console.error("An error occurred:",i.error.message):console.error(`Backend returned code ${i.status}, body was: ${i.error}`),(0,e._)("Something bad happened; please try again later.")}}return a.\u0275fac=function(i){return new(i||a)(t.LFG(c.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var d=o(3063),S=o(4527),C=o(8423),O=o(42);function M(a,v){1&a&&t._UZ(0,"img",16)}function I(a,v){1&a&&t._UZ(0,"img",17)}function E(a,v){1&a&&t._UZ(0,"img",18)}function y(a,v){if(1&a&&(t.TgZ(0,"div",9)(1,"div",10),t.YNc(2,M,1,0,"img",11),t.YNc(3,I,1,0,"img",12),t.YNc(4,E,1,0,"img",13),t.qZA(),t.TgZ(5,"div",14)(6,"p",15),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA()()()),2&a){const i=v.$implicit;t.xp6(2),t.Q6J("ngIf",i.componentTradeName&&"MOVIL"===(null==i?null:i.consumptionEntityType)),t.xp6(1),t.Q6J("ngIf",i.componentTradeName&&"IFIXED"===(null==i?null:i.consumptionEntityType)),t.xp6(1),t.Q6J("ngIf",i.componentTradeName&&"TV"===(null==i?null:i.consumptionEntityType)),t.xp6(3),t.Oqu(null==i?null:i.consumptionEntityType),t.xp6(2),t.Oqu(null==i?null:i.componentOffer)}}function D(a,v){if(1&a){const i=t.EpF();t.TgZ(0,"div")(1,"app-button",19),t.NdJ("click",function(){t.CHM(i);const P=t.oxw();return t.KtG(P.onClick())}),t.qZA()()}2&a&&(t.xp6(1),t.Q6J("content","Comprar este plan"))}const b=[{path:"",component:(()=>{class a{constructor(i,u,P,T,U,R,N,W){this.clientService=i,this.tokenService=u,this.route=P,this.router=T,this.planListService=U,this.webstoreService=R,this.ordersService=N,this.spinner=W,this.totalOfferTariff=0,this.showButton=!1}ngOnInit(){this.spinner.show(),this.webstoreService.clearWebStorePlanComposition(),this.route.queryParams.subscribe(i=>{this.planCompositionCode=i.code}),this.getToken()}getToken(){this.tokenService.gettoken().subscribe(i=>{this.autentication=i,this.getPlansList()})}getPlansList(){var i=this;this.planListService.getPlanList(this.autentication.data.token).subscribe({next:u=>{this.planesList=u;var T=this.planesList.data.data.filter(function(U){return U.planCompositionCode===i.planCompositionCode});this.planComposition=T[0],this.consumptionFormCode=this.planComposition?.consumptionFormCode,this.offerTariff=this.planComposition?.tariff,this.showButton=!0,this.spinner.hide()},error:u=>{console.error(u),this.spinner.hide(),alert("Ocurrio un error!! Por favor intente nuevamente...")},complete:()=>{console.log("complete")}})}calculateTotalOfferTariff(){let i=0;if("CCOPRE"==this.consumptionFormCode&&(i=this.offerTariff?this.offerTariff:179,this.planListServices=this.planComposition?.planList,this.planListServices))for(let u=0;u<this.planListServices.length;u++)i+=this.planListServices[u].categoryData.tariff?this.planListServices[u].categoryData.tariff:0;console.log("calculate offerTotalTariff",i),this.webstoreService.saveDataInSession("offerTotalTariff",i)}onClick(){this.webstoreService.savePlanCompositionCode(this.planCompositionCode),this.webstoreService.savePlanComposition(this.planComposition),this.webstoreService.saveDataInSession("offerConsumptionFormCode",this.consumptionFormCode),this.webstoreService.saveDataInSession("offerNumberOfEntities",this.planComposition?.numberOfEntities),this.calculateTotalOfferTariff(),this.router.navigate(["/client/validationClient"])}}return a.\u0275fac=function(i){return new(i||a)(t.Y36(m.y),t.Y36(g.B),t.Y36(l.gz),t.Y36(l.F0),t.Y36(p),t.Y36(d.f),t.Y36(S.N),t.Y36(C.t2))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-offer"]],decls:11,vars:3,consts:[[1,"container"],[1,"row","pb-5"],[1,"section-header","col-12","py-3"],[1,""],["src","assets/images/logo-viva.png","alt","",1,"pb-2",2,"width","200px","height","auto"],[1,"section-body","col-12","py-3"],[1,"d-flex","flex-column","justify-content-around","align-items-center"],["class","row w-100 border-top pt-2",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row","w-100","border-top","pt-2"],[1,"col-1","text-end"],["src","assets/images/iconos/movil.png","alt","","style","width: 20px; height: auto;",4,"ngIf"],["src","assets/images/iconos/wifi.png","alt","","style","width: 25px; height: auto;",4,"ngIf"],["src","assets/images/iconos/tv.png","alt","","style","width: 25px; height: auto;",4,"ngIf"],[1,"col-11"],[1,"component-title","mb-0","fw-bold"],["src","assets/images/iconos/movil.png","alt","",2,"width","20px","height","auto"],["src","assets/images/iconos/wifi.png","alt","",2,"width","25px","height","auto"],["src","assets/images/iconos/tv.png","alt","",2,"width","25px","height","auto"],[3,"content","click"]],template:function(i,u){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"section",2)(3,"div",3),t._UZ(4,"img",4),t.qZA()(),t.TgZ(5,"section",5)(6,"div",6)(7,"h3"),t._uU(8),t.qZA(),t.YNc(9,y,10,5,"div",7),t.YNc(10,D,2,1,"div",8),t.qZA()()()()),2&i&&(t.xp6(8),t.Oqu(null==u.planComposition?null:u.planComposition.groupTradeName),t.xp6(1),t.Q6J("ngForOf",null==u.planComposition?null:u.planComposition.planList),t.xp6(1),t.Q6J("ngIf",u.showButton))},dependencies:[r.sg,r.O5,O.r],styles:[".mat-card[_ngcontent-%COMP%]{padding:1px!important;width:100%;color:#7b7b7b}.section-body[_ngcontent-%COMP%]{background:white;color:#848484}.component-title[_ngcontent-%COMP%]{color:#5c339d}.section-header[_ngcontent-%COMP%]{background:linear-gradient(180deg,#D6F084 0%,rgba(214,240,132,0) 100%)}"]}),a})()}];let x=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[l.Bz.forChild(b),l.Bz]}),a})();var L=o(4466);let B=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[r.ez,x,L.m]}),a})()},42:(_,f,o)=>{o.d(f,{r:()=>g});var r=o(4650),l=o(4006),t=o(6895);function m(c,h){if(1&c&&(r.TgZ(0,"div",3),r._uU(1),r.qZA()),2&c){const s=r.oxw();r.xp6(1),r.Oqu(s.message)}}let g=(()=>{class c{constructor(){this.content="",this.styles="",this.disabled=!1,this.message=""}}return c.\u0275fac=function(s){return new(s||c)},c.\u0275cmp=r.Xpm({type:c,selectors:[["app-button"]],inputs:{content:"content",styles:"styles",disabled:"disabled",message:"message"},features:[r._Bn([{provide:l.JU,useExisting:(0,r.Gpc)(()=>c),multi:!0}])],decls:4,vars:4,consts:[[1,"button-wrap"],["class","button-message",4,"ngIf"],[1,"button-active",3,"ngClass","disabled"],[1,"button-message"]],template:function(s,e){1&s&&(r.TgZ(0,"div",0),r.YNc(1,m,2,1,"div",1),r.TgZ(2,"button",2),r._uU(3),r.qZA()()),2&s&&(r.xp6(1),r.Q6J("ngIf",e.message),r.xp6(1),r.Q6J("ngClass",e.disabled?"button-disactived":"button-active")("disabled",e.disabled),r.xp6(1),r.Oqu(e.content))},dependencies:[t.mk,t.O5],styles:[".button-active[_ngcontent-%COMP%]{background-color:#5c339d;font-size:1rem!important;padding:12px 10px;border-radius:20px;color:#fff;width:285px;height:44px!important;box-shadow:0 4px 15px #0000004d;font-family:MUSEO500-REGULAR}@media (max-width: 768px){.button-active[_ngcontent-%COMP%]{margin-right:0!important;font-size:.9em!important}}@media (max-width: 576px){.button-active[_ngcontent-%COMP%]{height:45px}}.button-wrap[_ngcontent-%COMP%]{margin-top:1.5vh}.button-disactived[_ngcontent-%COMP%]{background:#e0e0e0;font-size:1.1em;border-radius:20px;color:#000;margin-top:1.5vh;width:300px;height:40px;font-weight:700;border:2px solid #8260A5;font-family:MUSEO500-REGULAR;box-sizing:border-box}button[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;position:relative;transition:all .4s ease-in-out}.button-message[_ngcontent-%COMP%]{color:#fff;font-weight:900;font-size:small;font-family:MUSEO500-REGULAR;margin-bottom:4px}.button-active[_ngcontent-%COMP%]:hover{transform:scale(1.04,1.0000000099);-ms-transform:scale(1.04,1.0000000099);-webkit-transform:scale(1.04,1.0000000099)}button[_ngcontent-%COMP%]:focus{border-color:#0000;box-shadow:0 1px 1px #d0d0d0 inset,0 0 8px #dcdcdc;outline:0 none}"]}),c})()},5625:(_,f,o)=>{o.d(f,{X:()=>c});var r=o(4482),l=o(5403),t=o(4671),m=o(5963),g=o(8421);function c(h=1/0){let s;s=h&&"object"==typeof h?h:{count:h};const{count:e=1/0,delay:n,resetOnSuccess:p=!1}=s;return e<=0?t.y:(0,r.e)((d,S)=>{let O,C=0;const M=()=>{let I=!1;O=d.subscribe((0,l.x)(S,E=>{p&&(C=0),S.next(E)},void 0,E=>{if(C++<e){const y=()=>{O?(O.unsubscribe(),O=null,M()):I=!0};if(null!=n){const D="number"==typeof n?(0,m.H)(n):(0,g.Xf)(n(E,C)),A=(0,l.x)(S,()=>{A.unsubscribe(),y()},()=>{S.complete()});D.subscribe(A)}else y()}else S.error(E)})),I&&(O.unsubscribe(),O=null,M())};M()})}}}]);